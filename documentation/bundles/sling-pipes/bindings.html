<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Sling Pipes Bindings</title>
        <link rel="icon" href="/res/favicon.ico"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
    </head>    <body>
<div class="title">
            <div class="logo">
                <a href="http://sling.apache.org">
                    <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                </a>
            </div><div class="header">
                <a href="http://www.apache.org">
                    <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                </a>
            </div>
        </div><div class="menu">
            <p>
                <strong><a href="/documentation.html">Documentation</a></strong><br/>
                <a href="/documentation/getting-started.html">Getting Started</a><br/>
                <a href="/documentation/the-sling-engine.html">The Sling Engine</a><br/>
                <a href="/documentation/development.html">Development</a><br/>
                <a href="/documentation/bundles.html">Bundles</a><br/>
                <a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a><br/>
                <a href="http://sling.apache.org/components/">Maven Plugins</a><br/>
                <a href="/documentation/configuration.html">Configuration</a>
                
            </p><p>
                <a href="http://s.apache.org/sling.wiki">Wiki</a><br/>
                <a href="http://s.apache.org/sling.faq">FAQ</a><br/>
                
            </p><p>
                <strong>API Docs</strong><br/>
                <a href="/apidocs/sling10/index.html">Sling 10</a><br/>
                <a href="/apidocs/sling9/index.html">Sling 9</a><br/>
                <a href="/documentation/apidocs.html">All versions</a><br/>
                
            </p><p>
                <strong>Project Info</strong><br/>
                <a href="/downloads.cgi">Downloads</a><br/>
                <a href="http://www.apache.org/licenses/">License</a><br/>
                <a href="/news.html">News</a><br/>
                <a href="/releases.html">Releases</a><br/>
                <a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a><br/>
                <a href="/links.html">Links</a><br/>
                <a href="/contributing.html">Contributing</a><br/>
                <a href="/project-information.html">Project Information</a><br/>
                <a href="/project-information/security.html">Security</a><br/>
                
            </p><p>
                <strong>Source</strong><br/>
                <a href="https://github.com/apache/?utf8=%E2%9C%93&q=sling">GitHub</a><br/>
                <a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a><br/>
                
            </p><p>
                <strong><a href="/sitemap.html">Site Map</a></strong>
            </p><p>
                <strong>Apache Software Foundation</strong><br/>
                <a href="http://www.apache.org/foundation/thanks.html">Thanks!</a><br/>
                <a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a><br/>
                <a href="http://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a><br/>
                <a href="https://www.apache.org/events/current-event.html">
                    <img border="0" alt="Current ASF Events" src="https://www.apache.org/events/current-event-125x125.png" width="125px"/>
                </a><a href="http://apache.org/foundation/contributing.html">
                    <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125px"/>
                </a>
            </p>
        </div>        <div class="main">
            <div class="pagenav">
<div class="breadcrumbs">
                    <a href="/">
                        Home
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation.html">
                        Documentation
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation/bundles.html">
                        Bundles
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation/bundles/sling-pipes.html">
                        Sling Pipes
                    </a>&nbsp;&raquo;&nbsp;
                </div>                
<div class="tags">
                    <a href="/tags/pipes.html" class="label">
                        pipes
                    </a> 
                </div>                
                
            </div><h1 class="pagetitle">
                Sling Pipes Bindings
            </h1><div id="generatedToC"></div><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=pagetitle],h2,h3'}); } );</script>
<div class="row"><div class="small-12 columns"><section class="wrap"><p>in order to make things interesting, most of the configuration strings are javascript template strings, hence valid js expressions reusing bindings (from configuration, or other pipes).</p>
<h2><a href="#configuration-expression" name="configuration-expression">configuration expression</a></h2>
<p>an expression (path, expr, or property name or value in conf tree) can be either a pure string, like <code>/content/foo/bar</code> or <code>nt:unstructured[title=foo]</code>. But using <em>static</em> expressions like this is rather limited for most of the cases, hence usage of ECMA expressions like <code>/content/${one.value}/bar</code> or more sophisticated using functions <code>nt:unstructured[title=${getValue(currentField)}]</code></p>
<p>In case the expression has an error (bad expression, or undefined variable we'll name <code>bindings</code>) non instanciated expression will be outputed</p>
<h2><a href="#output-binding" name="output-binding">output binding</a></h2>
<p>each single pipe has to declare an output binding at the same time it outputs a resource. The binding will be named as the name of the pipe outputing it. If a pipe as been created as a sub pipe of a container with pipe builder api, it will have default name of "one", "two", ... depending on its position in the pipe, you can override the name with <code>.name(...)</code> api. </p>
<p>so following pipe</p>
<pre><code>    .echo(&#39;/content/foo&#39;)
    .children(&#39;nt:unstructured&#39;).name(&#39;example&#39;)
    .write(&#39;jcr:description&#39;,&#39;this node property prop = ${example.prop}&#39;)
</code></pre>
<p>with following <code>/content/foo</code> tree</p>
<pre><code>    { 
        &quot;jcr:primaryType&quot;:&quot;nt:unstructured&quot;,
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;firstVal&quot;
        },
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;secondVal&quot;
        }
    }
</code></pre>
<p>will loop twice on the pipe <code>example</code>, making available each time for the following pipes' expressions the default binding <code>example</code>,  which would be a map with one key prop. Accessing it with <code>{example.prop}</code> would give you <code>firstVal</code> and then <code>secondVal</code>.  So resulting tree will be</p>
<pre><code>    { 
        &quot;jcr:primaryType&quot;:&quot;nt:unstructured&quot;,
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;firstVal&quot;
            &quot;jcr:description&quot;:&quot;this node property prop = firstVal&quot;
        },
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;secondVal&quot;
            &quot;jcr:description&quot;:&quot;this node property prop = secondVal&quot;
        }
    }         
</code></pre>
<h2><a href="#additional-bindings" name="additional-bindings">additional bindings</a></h2>
<p>additional bindings is a <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#jcr-persistence-of-a-pipe.html">node you add to your pipe definition</a>, that sets bindings for the whole pipe execution. You can also add some through <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#pipe-builder-api">pipe builder api</a> with a map of bindings</p>
<pre><code>    .run(bindings)
</code></pre>
<p>or with a set of key / value pairs</p>
<pre><code>    .runWith(&quot;env&quot;, &quot;prod&quot;)
</code></pre>
<p><a href="/documentation/bundles/sling-pipes/execution-monitoring.html#http-api">http api</a> for this is a binding parameter</p>
<pre><code>    -F bindings=&#39;{&quot;env&quot;:&quot;prod&quot;}&#39;
</code></pre>
<h2><a href="#additional-scripts" name="additional-scripts">additional scripts</a></h2>
<p>some times you want heavy js logic in your expression instantiation. In that case, you need to store your javascript somewhere in the JCR, and mentions the path in the <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#jcr-persistence-of-a-pipe.html">additionalScripts MV property</a></p>
<h2><a href="#bindings-forward" name="bindings-forward">bindings forward</a></h2>
<p>in case a pipe references, or contain another pipe, same binding space will be used</p></section></div></div>            
            <div class="footer">
<div class="revisionInfo">
                    Last modified by <span class="author">Nicolas Peltier</span> on <span class="comment">Mon Oct 8 17:09:17 2018 +0200</span>
                </div>                <p>
                    Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
                </p><p>
                    Copyright © 2007-2018 The Apache Software Foundation.
                </p>
            </div>
            
        </div>
    </body>
</html>