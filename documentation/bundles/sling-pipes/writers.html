<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Writers</title>
        <link rel="icon" href="/res/favicon.ico"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
    </head>    <body>
<div class="title">
            <div class="logo">
                <a href="http://sling.apache.org">
                    <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                </a>
            </div><div class="header">
                <a href="http://www.apache.org">
                    <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                </a>
            </div>
        </div><div class="menu">
            <p>
                <strong><a href="/documentation.html">Documentation</a></strong><br/>
                <a href="/documentation/getting-started.html">Getting Started</a><br/>
                <a href="/documentation/the-sling-engine.html">The Sling Engine</a><br/>
                <a href="/documentation/development.html">Development</a><br/>
                <a href="/documentation/bundles.html">Bundles</a><br/>
                <a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a><br/>
                <a href="http://sling.apache.org/components/">Maven Plugins</a><br/>
                <a href="/documentation/configuration.html">Configuration</a>
                
            </p><p>
                <a href="http://s.apache.org/sling.wiki">Wiki</a><br/>
                <a href="http://s.apache.org/sling.faq">FAQ</a><br/>
                
            </p><p>
                <strong>API Docs</strong><br/>
                <a href="/apidocs/sling10/index.html">Sling 10</a><br/>
                <a href="/apidocs/sling9/index.html">Sling 9</a><br/>
                <a href="/documentation/apidocs.html">All versions</a><br/>
                
            </p><p>
                <strong>Project Info</strong><br/>
                <a href="/downloads.cgi">Downloads</a><br/>
                <a href="http://www.apache.org/licenses/">License</a><br/>
                <a href="/news.html">News</a><br/>
                <a href="/releases.html">Releases</a><br/>
                <a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a><br/>
                <a href="/links.html">Links</a><br/>
                <a href="/contributing.html">Contributing</a><br/>
                <a href="/project-information.html">Project Information</a><br/>
                <a href="/project-information/security.html">Security</a><br/>
                
            </p><p>
                <strong>Source</strong><br/>
                <a href="https://github.com/apache/?utf8=%E2%9C%93&q=sling">GitHub</a><br/>
                <a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a><br/>
                
            </p><p>
                <strong><a href="/sitemap.html">Site Map</a></strong>
            </p><p>
                <strong>Apache Software Foundation</strong><br/>
                <a href="http://www.apache.org/foundation/thanks.html">Thanks!</a><br/>
                <a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a><br/>
                <a href="http://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a><br/>
                <a href="https://www.apache.org/events/current-event.html">
                    <img border="0" alt="Current ASF Events" src="https://www.apache.org/events/current-event-125x125.png" width="125px"/>
                </a><a href="http://apache.org/foundation/contributing.html">
                    <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125px"/>
                </a>
            </p>
        </div>        <div class="main">
            <div class="pagenav">
<div class="breadcrumbs">
                    <a href="/">
                        Home
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation.html">
                        Documentation
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation/bundles.html">
                        Bundles
                    </a>&nbsp;&raquo;&nbsp;<a href="/documentation/bundles/sling-pipes.html">
                        Sling Pipes
                    </a>&nbsp;&raquo;&nbsp;
                </div>                
<div class="tags">
                    <a href="/tags/pipes.html" class="label">
                        pipes
                    </a> 
                </div>                
                
            </div><h1 class="pagetitle">
                Writers
            </h1><div id="generatedToC"></div><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=pagetitle],h2,h3'}); } );</script>
<div class="row"><div class="small-12 columns"><section class="wrap"><p>those pipes all are using common sling (or other) APIs to modify content. You'll probably need some <a href="/documentation/bundles/sling-pipes/readers.html">reader</a> pipes and/or <a href="/documentation/bundles/sling-pipes/logical.html">logical</a> pipes first to put you into the right context. </p>
<h5>Write Pipe (<code>write(conf)</code>)</h5>
<p>writes given nodes and properties to current input resource</p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/write</code></li>
  <li><code>conf</code> node tree that will be copied to the current input of the pipe, each property's names and value will be written to the input resource. Input resource will be outputed. Note that properties that will be evaluated (in an expression) as <code>null</code> for a given input resource will be removed from it. E.g. <code>./conf/some/node@prop=${null}</code> will add <code>./conf/some/node</code> structure if not in current input resource, but remove its <code>prop</code> property if any).</li>
  <li><code>expr</code> used if no configuration node provided: path of a content tree this will write to the current destination (basically a deep copy)</li>
</ul>
<p>For most of the case where you just need to write properties, pipe builder API allows you to e.g.</p>
<pre><code>    .echo(&#39;/content/foo&#39;)
    .write(&#39;foo1&#39;,&#39;bar1&#39;,&#39;foo2&#39;,&#39;bar2&#39;)
</code></pre>
<p>will write <code>@foo1=bar1</code> and <code>@foo2=bar2</code> in <code>/content/foo</code>. For more complicated cases where you need a structure to be written, just use a JCR / Resource explorer to edit the persistence of the pipe, and create the given structured under conf.</p>
<p>Note that using <code>expr</code> you need configuration node <em>not</em> to be here, and {{write}} shortcut creates one systematically. So if you want to use pipe builder and that, you'd need something like</p>
<pre><code>    .echo(&#39;/content/destination&#39;)
    .pipe(&quot;slingPipes/write&quot;).expr(&quot;/content/source&quot;)
</code></pre>
<h5>MovePipe (<code>mv(expr)</code>)</h5>
<p>JCR move of current input to target path (can be a node or a property)</p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/mv</code></li>
  <li><code>expr</code> full target path, note that parent path must exists
    <pre><code>.echo(&quot;/content/foo/old/location&quot;)
.mv(&quot;/content/bar/new/location&quot;)
</code></pre>
  </li>
</ul>
<h5>RemovePipe (<code>rm()</code>)</h5>
<p>removes the input resource, returns the parent, regardless of the resource being a node, or a property</p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/rm</code></li>
  <li><code>conf</code> node tree that will be used to filter relative properties &amp; subtrees to the current resource to remove. A subnode is considered to be removed if it has no property configured, nore any child.</li>
</ul>
<p>more common usage is just without configuration node, removing incoming resource</p>
<pre><code>    .echo(&quot;/content/foo/toRemove&quot;)
    .rm() 
</code></pre>
<h5>PathPipe (<code>mkdir(expr)</code>)</h5>
<p>get or create path given in expression. Uses <a href="https://sling.apache.org/apidocs/sling8/org/apache/sling/api/resource/ResourceUtil.html#getOrCreateResource-org.apache.sling.api.resource.ResourceResolver-java.lang.String-java.lang.String-java.lang.String-boolean-">ResourceUtil.getOrCreateResource</a></p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/path</code></li>
  <li><code>nodeType</code> node type of the intermediate nodes to create</li>
  <li><code>autosave</code> should save at each creation (will make things slow, but sometimes you don't have choice)
    <pre><code>.mkdir(&quot;/content/foo/bar&quot;)
</code></pre>
  </li>
</ul>
<p>will create a <code>/content/foo/bar</code> path of <code>sling:Folder</code> nodes</p>
<h5>PackagePipe (<code>pkg(expr)</code>)</h5>
<p>will create a package and add current resource as a filter. At the end of super pipe execution, will attempt to build the package - <code>sling:resourceType</code> is <code>slingPipes/package</code> - <code>expr</code> package path</p>
<p>This example searches for folders in a given location and package them up</p>
<pre><code>    .echo(&quot;/content/foo/bar&quot;)
    .$(&quot;sling:Folder&quot;)
    .pkg(&quot;/etc/packages/foobar-folders.zip&quot;)
</code></pre>
<h5>AuthorizablePipe (<code>auth(conf)</code>)</h5>
<p>retrieve authorizable resource corresponding to the id passed in expression, or if not found (or void expression), from the input path, output the found authorizable's resource caution this pipe <strong>can modify content</strong> in case additional configuration is added (see below)</p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/authorizable</code></li>
  <li><code>expr</code> should be an authorizable id, or void (but then input should be an authorizable)</li>
  <li><code>autoCreateGroup</code> (boolean) if autorizable id is here, but the authorizable not present, then create group with given id (in that case, considered as a write pipe)</li>
  <li><code>addMembers</code> (stringified json array) if authorizable is a group, add instanciated members to it (in that case, considered as a write pipe)</li>
  <li><code>addToGroup</code> (expression) add found authorizable to instanciated group (in that case, considered as a write pipe)</li>
  <li><code>bindMembers</code> (boolean) if found authorizable is a group, bind the members (in that case, considered as a write pipe)</li>
</ul>
<p>This example creates a group</p>
<pre><code>    .auth(&quot;createGroup&quot;, true).expr(&quot;foo-bar&quot;)
</code></pre>
<p>This example searches for users in a given location and add them to <code>foo-bar</code> group</p>
<pre><code>    .echo(&quot;/home/users/foo&quot;)
    .$(&quot;rep:User&quot;)
    .auth(&quot;addToGroup&quot;, &quot;foo-bar&quot;)
</code></pre>
<p>In this example, auth is not writing anything but makes use of bind members and json to create one content tree per admin</p>
<pre><code>    .auth(&quot;bindMembers&quot;,true).expr(&quot;administrators&quot;)
    .json(&#39;${one}&#39;)
    .mkdir(&#39;/content/admin-users/${two}&#39;)
</code></pre>
<h5>ACLPipe (<code>acls(), allow(expr), deny(expr)</code>)</h5>
<p>either output ACL of current resource in the output bindings, or allow / deny default or configured privileges for the authorizable passed as the expression</p>
<ul>
  <li><code>sling:resourceType</code> is <code>slingPipes/acl</code></li>
  <li><code>expr</code> should be an authorizable id, or void</li>
  <li><code>allow</code> (boolean) to allow some privileges for configured authorizable</li>
  <li><code>deny</code> (boolean) to deny some privileges for configured authorizable</li>
</ul>
<p>following will give bar-users authorizable the right to read on /content/foo/bar</p>
<pre><code>    .echo(&quot;/content/foo/bar&quot;)
    .allow(&quot;bar-users&quot;)
</code></pre></section></div></div>            
            <div class="footer">
<div class="revisionInfo">
                    Last modified by <span class="author">Nicolas Peltier</span> on <span class="comment">Mon Oct 8 17:09:17 2018 +0200</span>
                </div>                <p>
                    Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
                </p><p>
                    Copyright © 2007-2018 The Apache Software Foundation.
                </p>
            </div>
            
        </div>
    </body>
</html>