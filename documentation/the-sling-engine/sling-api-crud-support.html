<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Sling API CRUD Support</title>
        <link rel="icon" href="/res/favicon.ico"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
    </head>    <body>
<div class="title">
            <div class="logo">
                <a href="https://sling.apache.org">
                    <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                </a>
            </div><div class="header">
                <a href="https://www.apache.org">
                    <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                </a>
            </div>
        </div><nav class="menu">
            <ul>
                <li>
                    <strong>Documentation</strong><ul>
                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                    </ul>
                </li><li>
                    <strong>API Docs</strong><ul>
                        <li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                    </ul>
                </li><li>
                    <strong>Support</strong><ul>
                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Site Map</a></li>
                    </ul>
                </li><li>
                    <strong>Project Info</strong><ul>
                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                    </ul>
                </li><li>
                    <strong>Source</strong><ul>
                        <li><a href="https://github.com/apache/?utf8=%E2%9C%93&q=sling">GitHub</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                    </ul>
                </li><li>
                    <strong>Apache Software Foundation</strong><ul>
                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li><li><a href="https://www.apache.org/events/current-event.html">
                                <img border="0" alt="Current ASF Events" src="https://www.apache.org/events/current-event-125x125.png" width="125"/>
                            </a></li><li><a href="https://apache.org/foundation/contributing.html">
                                <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                            </a></li>
                    </ul>
                </li>
            </ul>
        </nav>        <div class="main">
            <div class="pagenav">
<div class="breadcrumb">
                    <a href="/">
                        Home
                    </a><a href="/documentation.html">
                        Documentation
                    </a><a href="/documentation/the-sling-engine.html">
                        The Sling Engine
                    </a>
                </div>                
<div class="tags">
                    <span class="tag">
                        <a href="/tags/api.html">
                            api
                        </a>
                    </span><span class="tag">
                        <a href="/tags/core.html">
                            core
                        </a>
                    </span>
                </div>                
                
            </div><h1 class="pagetitle">
                Sling API CRUD Support
            </h1><div id="generatedToC"></div><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=pagetitle],h2,h3'}); } );</script>
<div class="row"><div class="small-12 columns"><section class="wrap"><p><!-- TODO reactivate TOC once JBake moves to flexmark-java -->
</p>
<h2><a href="#apache-sling-api-support" name="apache-sling-api-support">Apache Sling API Support</a></h2>
<p>As of version 2.3.0, the Sling API provides full Create Read Update Delete (CRUD) features. CRUD support is provided by the addition of the following methods to the ResourceResolver:</p>
<ul>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#delete-org.apache.sling.api.resource.Resource-">void delete(Resource resource) throws PersistenceException</a></li>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#create-org.apache.sling.api.resource.Resource-java.lang.String-java.util.Map-">Resource create(Resource parent, String name, Map&lt;String, Object&gt; properties) throws PersistenceException</a></li>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#revert--">void revert()</a></li>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#commit--">void commit() throws PersistenceException</a></li>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#hasChanges--">boolean hasChanges()</a></li>
  <li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#refresh--">void refresh()</a></li>
</ul>
<p>Which provide the ability to create and delete resources as well as the addition of the ModifiableValueMap interface which is similar to the ValueMap interface, but allows for updating properties on a resource.</p>
<h2><a href="#comparing-sling-api-crud-to-sling-post-servlet" name="comparing-sling-api-crud-to-sling-post-servlet">Comparing Sling API CRUD to Sling Post Servlet</a></h2>
<p>Here are some examples of common operations performed using the Sling Post Servlet and Sling API CRUD support. Note, the examples are derived from the <a href="http://dev.day.com/content/ddc/blog/2008/07/cheatsheet/_jcr_content/images/cheatsheet/back.png">SlingPostServlet Cheatsheet</a>.</p>
<h3><a href="#updating-a-property" name="updating-a-property">Updating a Property</a></h3>
<p>Update /myresource, setting the title and body:</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;
  &lt;textarea name=&quot;body&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
ModifiableValueMap properties = myNode.adaptTo(ModifiableValueMap.class);
properties.put(&quot;title&quot;, {TITLE});
properties.put(&quot;body&quot;, {BODY});
resourceResolver.commit();
</code></pre>
<h3><a href="#create-new-resource" name="create-new-resource">Create New Resource</a></h3>
<p>Create a new resource below /myresource</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource/&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;dummy&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
Map&lt;String,Object&gt; properties = new HashMap&lt;String,Object&gt;();
properties.put(&quot;jcr:primaryType&quot;, &quot;nt:unstructured&quot;);
properties.put(&quot;sling:resourceType&quot;, &quot;myapp/components/mytype&quot;);
Resource dummy = resourceResolver.create(myResource, &quot;dummy&quot;, properties);
resourceResolver.commit();
</code></pre>
<h3><a href="#remove-a-property" name="remove-a-property">Remove a Property</a></h3>
<p>Remove the property title</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;title@Delete&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
ModifiableValueMap properties = myResource.adaptTo(ModifiableValueMap.class);
properties.remove(&quot;title&quot;);
resourceResolver.commit();
</code></pre>
<h3><a href="#copy-a-resource" name="copy-a-resource">Copy a Resource</a></h3>
<p>Copy the resource /myresource to /myresource2</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;copy&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:dest&quot; value=&quot;/myresource2&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:replace&quot; value=&quot;true&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Map&lt;String,Object&gt; properties = myResource.adaptTo(ValueMap.class);
Resource myResource2 = resourceResolver.create(null, &quot;myresource2&quot;, properties);
resourceResolver.commit();
</code></pre>
<h3><a href="#move-a-resource" name="move-a-resource">Move a Resource</a></h3>
<p>Move the resource /myresource2 to /myresource3</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource2&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;move&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:dest&quot; value=&quot;/myresource3&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource2 = resourceResolver.getResource(&quot;/myresource2&quot;);
Map&lt;String,Object&gt; properties = myResource2.adaptTo(ValueMap.class);
Resource myResource3 = resourceResolver.create(null, &quot;myresource3&quot;, properties);
resourceResolver.delete(myResource2);
resourceResolver.commit();
</code></pre>
<h3><a href="#setting-non-string-value" name="setting-non-string-value">Setting non-String Value</a></h3>
<p>Set the property date to a particular date</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource3&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;date&quot; value=&quot;2008-06-13T18:55:00&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;date@TypeHint&quot; value=&quot;Date&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource3 = resourceResolver.getResource(&quot;/myresource3&quot;);
Calendar calendar = [SOME_DATE];
ModifiableValueMap properties = myResource3.adaptTo(ModifiableValueMap.class);
properties.put(&quot;date&quot;, calendar);
resourceResolver.commit();
</code></pre>
<h3><a href="#delete-a-resource" name="delete-a-resource">Delete a Resource</a></h3>
<p>Delete the resource /myresource</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;delete&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
resourceResolver.delete(myResource);
resourceResolver.commit();
</code></pre>
<h2><a href="#value-class-support" name="value-class-support">Value Class Support</a></h2>
<div class="info">
	Please note, this information is specific to the Sling JCR Resource implementation provided by the Apache Sling project.  Other implementations may have different value class support.  
</div>
<p>The Classes implementing the following types are supported directly when setting properties:</p>
<ul>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html">Calendar</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html">InputStream</a></li>
  <li><a href="http://www.day.com/maven/javax.jcr/javadocs/jcr-2.0/javax/jcr/Node.html">Node</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html">BigDecimal</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html">Long</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Short.html">Short</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html">Integer</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Number.html">Number</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Boolean.html">Boolean</a></li>
  <li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a></li>
</ul>
<p>As well as the corresponding primitive types. Any object which implements the Serializable interface will be serialized and the result of the serialization will be saved as a binary value for the property.</p></section></div></div>            
            <footer class="footer">
<div class="revisionInfo">
                    Last modified by <span class="author">Bertrand Delacretaz</span> on <span class="comment">Fri Sep 29 15:36:08 2017 +0200</span>
                </div>                <p>
                    Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
                </p><p>
                    Copyright © 2007-2019 The Apache Software Foundation.
                </p>
            </footer>
            
        </div>
    </body>
</html>